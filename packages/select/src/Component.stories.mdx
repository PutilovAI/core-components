import { Meta, Story, Props, Title } from '@storybook/addon-docs/blocks';

import { Select } from './Component';
import { Field } from './components/Field';
import { Menu } from './components/Menu';
import { Optgroup } from './components/Optgroup';
import { MenuItem } from './components/MenuItem';
import { name, version } from '../package.json';

import Icon from '@alfalab/icons-classic/BankAlfaMBlackIcon';

export const items = [
    { value: '1', text: 'Neptunium', disabled: true },
    { value: '2', text: 'Plutonium' },
    { value: '3', text: 'Americium' },
    { value: '4', text: 'Curium' },
    { value: '5', text: 'Berkelium' },
    { value: '6', text: 'Californium' },
    { value: '7', text: 'Einsteinium' },
    { value: '8', text: 'Fermium' },
    { value: '9', text: 'Mendelevium' },
    { value: '10', text: 'Nobelium' },
    { value: '11', text: 'Lawrencium' },
    { value: '12', text: 'Rutherfordium' },
    { value: '13', text: 'Dubnium' },
    { value: '14', text: 'Seaborgium' },
    { value: '15', text: 'Bohrium' },
];

export const groups = [
    {
        label: 'group1',
        items: [
            { value: '1', text: 'Neptunium', disabled: true },
            { value: '2', text: 'Plutonium' },
            { value: '3', text: 'Americium' },
            { value: '4', text: 'Curium' },
        ]
    },
    {
        label: 'group2',
        items: [
            { value: '5', text: 'Berkelium' },
            { value: '6', text: 'Californium' },
            { value: '7', text: 'Einsteinium' },
            { value: '8', text: 'Fermium' },
            { value: '9', text: 'Mendelevium' },
            { value: '10', text: 'Nobelium' },
        ]
    },
    {
        label: 'group3',
        items: [
            { value: '11', text: 'Lawrencium' },
            { value: '12', text: 'Rutherfordium' },
            { value: '13', text: 'Dubnium' },
            { value: '14', text: 'Seaborgium' },
            { value: '15', text: 'Bohrium' },
        ]
    },
];

export const itemsWithHtml = items.map(item => {
    return {
        ...item,
        text: (<span style={{ border: '1px solid red'}}>{item.text}</span>),
        nativeText: item.text
    };
});

export const onChange = (event, payload) => {
    const form = document.getElementById('form');
    const data = new FormData(form);
    console.log(event, payload);
    console.log(Array.from(data.entries()));
};

export const renderUppercased = (items) => {
    return items.map(item => item.text.toUpperCase()).join(', ');
};

<Meta title='Компоненты|Select' component={Select} />

<Title>
    Select ({name}@{version})
</Title>

```tsx
import { Select } from '@alfalab/core-components-select';
```

## Описание

Компонент селект.

<Story name='Песочница'>
    <form id="form">
        <div style={{ marginBottom: '10px', width: '200px'}}>
            <Select
                block={true}
                items={items}
                multiple={true}
                placeholder='Выберите элемент'
                label='Элемент'
                name='select1'
                onChange={onChange}
            />
        </div>
        <div style={{ marginBottom: '10px', width: '200px'}}>
            <Select
                block={true}
                items={groups}
                placeholder='Выберите элемент'
                label='Элемент'
                name='select2'
                onChange={onChange}
            />
        </div>
        <div style={{ marginBottom: '10px', width: '200px'}}>
            {React.createElement(() => {
                const [selected, setSelected] = React.useState([itemsWithHtml[1], itemsWithHtml[2]]);
                const handleChange = (event, payload) => {
                    setSelected(payload.selected);
                };
                return (
                    <Select
                        block={true}
                        items={itemsWithHtml}
                        placeholder='Выберите элемент'
                        label='controlled'
                        name='select2'
                        multiple={true}
                        onChange={handleChange}
                        selected={selected}
                    />
                );
            })}
        </div>
        <div style={{ marginBottom: '10px'}}>
            <Select
                items={items}
                label='Элемент'
                name='select2'
                multiple={true}
                nativeMenu={true}
                onChange={onChange}
                size="m"
            />
        </div>
        <div style={{ marginBottom: '10px'}}>
            <Select
                items={items}
                label='Native'
                name='select2'
                nativeMenu={true}
                onChange={onChange}
                size="m"
            />
        </div>
        <div style={{ marginBottom: '10px'}}>
            <Select
                items={items}
                label='Элемент'
                name='select2'
                multiple={true}
                allowUnselect={true}
                size="l"
                onChange={onChange}
                Field={(props) => <Field {...props} showArrow={false} valueRenderer={renderUppercased} />}
            />
        </div>
        <div style={{ marginBottom: '10px'}}>
            {React.createElement(() => {
                const renderValue = (item) => (
                    <span style={{ display: 'flex' }} key={item.value}>
                        <Icon />
                        {item.text}
                    </span>
                );
                const renderFieldValue = (items) => items.map(renderValue);
                return (
                    <Select
                        items={items}
                        label='Кастомный контент'
                        name='select3'
                        allowUnselect={true}
                        valueRenderer={renderFieldValue}
                        itemRenderer={renderValue}
                        onChange={onChange}
                    />
                );
            })}
        </div>
        <div style={{ marginBottom: '10px'}}>
            {React.createElement(() => {
                const CustomField = ({ selectedItems }) => {
                    return (
                        <span style={{ background: '#ff4784', color: '#fff', display: 'block' }}>
                            {selectedItems.length === 0 ? 'Custom field.' : ' Selected: '}
                            {selectedItems.map(item => item.text.toUpperCase()).join(', ')}
                        </span>
                    );
                };
                return (
                    <Select
                        items={items}
                        label='Элемент'
                        name='select3'
                        allowUnselect={true}
                        Field={CustomField}
                        onChange={onChange}
                    />
                );
            })}
        </div>
    </form>
</Story>

## Select Props

<Props of={Select} />

## Field Props

<Props of={Field} />

## Menu Props

<Props of={Menu} />

## Optgroup Props

<Props of={Optgroup} />

## MenuItem Props

<Props of={MenuItem} />
