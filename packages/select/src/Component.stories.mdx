import { Meta, Story, Props, Title } from '@storybook/addon-docs/blocks';

import { Select } from './Component';
import { Field } from './components/field';
import { OptionsList } from './components/options-list';
import { Optgroup } from './components/optgroup';
import { Option } from './components/option';
import { name, version } from '../package.json';

import Icon from '@alfalab/icons-classic/BankAlfaMBlackIcon';

export const options = [
    { value: '1', text: 'Neptunium', disabled: true },
    { value: '2', text: 'Plutonium' },
    { value: '3', text: 'Americium' },
    { value: '4', text: 'Curium' },
    { value: '5', text: 'Berkelium' },
    { value: '6', text: 'Californium' },
    { value: '7', text: 'Einsteinium' },
    { value: '8', text: 'Fermium' },
    { value: '9', text: 'Mendelevium' },
    { value: '10', text: 'Nobelium' },
    { value: '11', text: 'Lawrencium' },
    { value: '12', text: 'Rutherfordium' },
    { value: '13', text: 'Dubnium' },
    { value: '14', text: 'Seaborgium' },
    { value: '15', text: 'Bohrium' },
];

export const groups = [
    {
        label: 'group1',
        options: [
            { value: '1', text: 'Neptunium', disabled: true },
            { value: '2', text: 'Plutonium' },
            { value: '3', text: 'Americium' },
            { value: '4', text: 'Curium' },
        ]
    },
    {
        label: 'group2',
        options: [
            { value: '5', text: 'Berkelium' },
            { value: '6', text: 'Californium' },
            { value: '7', text: 'Einsteinium' },
            { value: '8', text: 'Fermium' },
            { value: '9', text: 'Mendelevium' },
            { value: '10', text: 'Nobelium' },
        ]
    },
    {
        label: 'group3',
        options: [
            { value: '11', text: 'Lawrencium' },
            { value: '12', text: 'Rutherfordium' },
            { value: '13', text: 'Dubnium' },
            { value: '14', text: 'Seaborgium' },
            { value: '15', text: 'Bohrium' },
        ]
    },
];

export const optionsWithHtml = options.map(option => {
    return {
        ...option,
        text: (<span style={{ border: '1px solid red'}}>{option.text}</span>),
        nativeText: option.text
    };
});

export const onChange = (event, payload) => {
    const form = document.getElementById('form');
    const data = new FormData(form);
    console.log(event, payload);
    console.log(Array.from(data.entries()));
};

export const renderUppercased = (options) => {
    return options.map(option => option.text.toUpperCase()).join(', ');
};

<Meta title='Компоненты|Select' component={Select} />

<Title>
    Select ({name}@{version})
</Title>

```tsx
import { Select } from '@alfalab/core-components-select';
```

## Описание

Компонент селект.

<Story name='Песочница'>
    <form id="form">
        <div style={{ marginBottom: '10px', width: '200px'}}>
            <Select
                block={true}
                options={options}
                multiple={true}
                placeholder='Выберите элемент'
                label='Элемент'
                name='select1'
                onChange={onChange}
            />
        </div>
        <div style={{ marginBottom: '10px', width: '200px'}}>
            <Select
                block={true}
                options={groups}
                multiple={true}
                placeholder='Выберите элемент'
                label='Элемент'
                name='select2'
                onChange={onChange}
                nativeSelect={true}
            />
        </div>
        <div style={{ marginBottom: '10px', width: '200px'}}>
            {React.createElement(() => {
                const [selected, setSelected] = React.useState([optionsWithHtml[1], optionsWithHtml[2]]);
                const handleChange = (event, payload) => {
                    setSelected(payload.selected);
                };
                return (
                    <Select
                        block={true}
                        options={optionsWithHtml}
                        placeholder='Выберите элемент'
                        label='controlled'
                        name='select2'
                        multiple={true}
                        onChange={handleChange}
                        selected={selected}
                    />
                );
            })}
        </div>
        <div style={{ marginBottom: '10px'}}>
            <Select
                options={options}
                label='Элемент'
                name='select2'
                multiple={true}
                nativeSelect={true}
                onChange={onChange}
                size="m"
            />
        </div>
        <div style={{ marginBottom: '10px'}}>
            <Select
                options={options}
                label='Native'
                name='select2'
                nativeSelect={true}
                onChange={onChange}
                size="m"
            />
        </div>
        <div style={{ marginBottom: '10px'}}>
            <Select
                options={options}
                label='Элемент'
                name='select2'
                multiple={true}
                allowUnselect={true}
                size="l"
                onChange={onChange}
                Field={(props) => <Field {...props} showArrow={false} valueRenderer={renderUppercased} />}
            />
        </div>
        <div style={{ marginBottom: '10px'}}>
            {React.createElement(() => {
                const renderOption = (option) => (
                    <span style={{ display: 'flex' }} key={option.value}>
                        <Icon />
                        {option.text}
                    </span>
                );
                const renderFieldValue = (options) => options.map(renderOption);
                return (
                    <Select
                        options={options}
                        label='Кастомный контент'
                        name='select3'
                        allowUnselect={true}
                        valueRenderer={renderFieldValue}
                        optionRenderer={renderOption}
                        onChange={onChange}
                    />
                );
            })}
        </div>
        <div style={{ marginBottom: '10px'}}>
            {React.createElement(() => {
                const CustomField = ({ value }) => {
                    return (
                        <span style={{ background: '#ff4784', color: '#fff', display: 'block' }}>
                            {value.length === 0 ? 'Custom field.' : ' Selected: '}
                            {value.map(option => option.text.toUpperCase()).join(', ')}
                        </span>
                    );
                };
                return (
                    <Select
                        options={options}
                        label='Элемент'
                        name='select3'
                        allowUnselect={true}
                        Field={CustomField}
                        onChange={onChange}
                    />
                );
            })}
        </div>
    </form>
</Story>

## Select Props

<Props of={Select} />

## Field Props

<Props of={Field} />

## OptionsList Props

<Props of={OptionsList} />

## Optgroup Props

<Props of={Optgroup} />

## Option Props

<Props of={Option} />
